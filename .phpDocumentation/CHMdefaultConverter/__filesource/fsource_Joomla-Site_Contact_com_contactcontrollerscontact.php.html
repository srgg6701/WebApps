<!--
	IE 6 makes the page to wide with the following doctype. I accept
	standards if they help me, not if they make anything even harder!
//-->
<!--<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.0 Transitional//EN' 'http://www.w3.org/TR/REC-html40/loose.dtd'>//-->
<!--NewPage-->
<HTML>
<HEAD>
	<!-- Generated by PhpDoc date: 'Sun, 29 Jul 2012 11:24:01 +0400' -->
	<TITLE>File Source for contact.php</TITLE>
<LINK REL ='stylesheet' TYPE='text/css' HREF='../media/stylesheet.css' TITLE='Style'>
</HEAD>
<BODY BGCOLOR='white'>
<a name="top"><!-- --></a><h1 align="center">Source for file contact.php</h1>
<p>Documentation is available at <a href="../Joomla-Site/Contact/_com_contact---controllers---contact.php.html">contact.php</a></p>
<pre><li><div class="src-line"><a name="a1"></a><strong>&lt;?php</strong></div></li>
<li><div class="src-line"><a name="a2"></a><font color="#009999">/**</font></div></li>
<li><div class="src-line"><a name="a3"></a><font color="#009999">&nbsp;*&nbsp;</font><strong><font color = "#0099FF">@package</font></strong><font color="#009999">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Joomla.Site</font></div></li>
<li><div class="src-line"><a name="a4"></a><font color="#009999">&nbsp;*&nbsp;</font><strong><font color = "#0099FF">@subpackage</font></strong><font color="#009999">&nbsp;&nbsp;&nbsp;&nbsp;Contact</font></div></li>
<li><div class="src-line"><a name="a5"></a><font color="#009999">&nbsp;*&nbsp;</font><strong><font color = "#0099FF">@copyright</font></strong><font color="#009999">&nbsp;&nbsp;&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;2005&nbsp;-&nbsp;2012&nbsp;Open&nbsp;Source&nbsp;Matters,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</font></div></li>
<li><div class="src-line"><a name="a6"></a><font color="#009999">&nbsp;*&nbsp;</font><strong><font color = "#0099FF">@license</font></strong><font color="#009999">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GNU&nbsp;General&nbsp;Public&nbsp;License&nbsp;version&nbsp;2&nbsp;or&nbsp;later;&nbsp;see&nbsp;LICENSE.txt</font></div></li>
<li><div class="src-line"><a name="a7"></a><font color="#009999">&nbsp;*/</font></div></li>
<li><div class="src-line"><a name="a8"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a9"></a><a href="http://www.php.net/defined">defined</a><strong>(</strong><font color="#66cccc">'_JEXEC'</font><strong>)&nbsp;</strong>or&nbsp;die<strong>;</strong></div></li>
<li><div class="src-line"><a name="a10"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a11"></a>jimport<strong>(</strong><font color="#66cccc">'joomla.application.component.controllerform'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a12"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a13"></a><font color="blue">class&nbsp;</font><a href="../Joomla-Site/Contact/ContactControllerContact.html">ContactControllerContact</a>&nbsp;<font color="blue">extends&nbsp;</font>JControllerForm</div></li>
<li><div class="src-line"><a name="a14"></a><strong>{</strong></div></li>
<li><div class="src-line"><a name="a15"></a>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">public&nbsp;</font><font color="blue">function&nbsp;</font><a href="../Joomla-Site/Contact/ContactControllerContact.html#methodgetModel">getModel</a><strong>(</strong><strong>$name&nbsp;</strong>=&nbsp;<font color="#66cccc">''</font><strong>,&nbsp;</strong><strong>$prefix&nbsp;</strong>=&nbsp;<font color="#66cccc">''</font><strong>,&nbsp;</strong><strong>$config&nbsp;</strong>=&nbsp;array<strong>(</strong><font color="#66cccc">'ignore_request'&nbsp;</font>=&gt;&nbsp;true<strong>))</strong></div></li>
<li><div class="src-line"><a name="a16"></a>&nbsp;&nbsp;&nbsp;&nbsp;<strong>{</strong></div></li>
<li><div class="src-line"><a name="a17"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">return&nbsp;</font>parent<strong>::</strong>getModel<strong>(</strong><strong>$name</strong><strong>,&nbsp;</strong><strong>$prefix</strong><strong>,&nbsp;</strong>array<strong>(</strong><font color="#66cccc">'ignore_request'&nbsp;</font>=&gt;&nbsp;false<strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a18"></a>&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a19"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a20"></a>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">public&nbsp;</font><font color="blue">function&nbsp;</font><a href="../Joomla-Site/Contact/ContactControllerContact.html#methodsubmit">submit</a><strong>(</strong><strong>)</strong></div></li>
<li><div class="src-line"><a name="a21"></a>&nbsp;&nbsp;&nbsp;&nbsp;<strong>{</strong></div></li>
<li><div class="src-line"><a name="a22"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Check&nbsp;for&nbsp;request&nbsp;forgeries.</font></div></li>
<li><div class="src-line"><a name="a23"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JRequest<strong>::</strong>checkToken<strong>(</strong><strong>)&nbsp;</strong>or&nbsp;jexit<strong>(</strong>JText<strong>::</strong>_<strong>(</strong><font color="#66cccc">'JINVALID_TOKEN'</font><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a24"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a25"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Initialise&nbsp;variables.</font></div></li>
<li><div class="src-line"><a name="a26"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$app&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;JFactory<strong>::</strong>getApplication<strong>(</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a27"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$model&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$this</strong><strong>-&gt;</strong><a href="../Joomla-Site/Contact/ContactControllerContact.html#methodgetModel">getModel</a><strong>(</strong><font color="#66cccc">'contact'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a28"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$params&nbsp;</strong>=&nbsp;JComponentHelper<strong>::</strong>getParams<strong>(</strong><font color="#66cccc">'com_contact'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a29"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$stub&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;JRequest<strong>::</strong>getString<strong>(</strong><font color="#66cccc">'id'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a30"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;(int)<strong>$stub</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a31"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a32"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Get&nbsp;the&nbsp;data&nbsp;from&nbsp;POST</font></div></li>
<li><div class="src-line"><a name="a33"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$data&nbsp;</strong>=&nbsp;JRequest<strong>::</strong>getVar<strong>(</strong><font color="#66cccc">'jform'</font><strong>,&nbsp;</strong>array<strong>(</strong><strong>)</strong><strong>,&nbsp;</strong><font color="#66cccc">'post'</font><strong>,&nbsp;</strong><font color="#66cccc">'array'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a34"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a35"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$contact&nbsp;</strong>=&nbsp;<strong>$model</strong><strong>-&gt;</strong>getItem<strong>(</strong><strong>$id</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a36"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a37"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a38"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$params</strong><strong>-&gt;</strong>merge<strong>(</strong><strong>$contact</strong><strong>-&gt;</strong>params<strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a39"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a40"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Check&nbsp;for&nbsp;a&nbsp;valid&nbsp;session&nbsp;cookie</font></div></li>
<li><div class="src-line"><a name="a41"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if</font><strong>(</strong><strong>$params</strong><strong>-&gt;</strong>get<strong>(</strong><font color="#66cccc">'validate_session'</font><strong>,&nbsp;</strong>0<strong>))&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a42"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if</font><strong>(</strong>JFactory<strong>::</strong>getSession<strong>(</strong><strong>)</strong><strong>-&gt;</strong>getState<strong>(</strong><strong>)&nbsp;</strong>!=&nbsp;<font color="#66cccc">'active'</font><strong>)</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a43"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JError<strong>::</strong>raiseWarning<strong>(</strong>403<strong>,&nbsp;</strong>JText<strong>::</strong>_<strong>(</strong><font color="#66cccc">'COM_CONTACT_SESSION_INVALID'</font><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a44"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a45"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Save&nbsp;the&nbsp;data&nbsp;in&nbsp;the&nbsp;session.</font></div></li>
<li><div class="src-line"><a name="a46"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$app</strong><strong>-&gt;</strong>setUserState<strong>(</strong><font color="#66cccc">'com_contact.contact.data'</font><strong>,&nbsp;</strong><strong>$data</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a47"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a48"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Redirect&nbsp;back&nbsp;to&nbsp;the&nbsp;contact&nbsp;form.</font></div></li>
<li><div class="src-line"><a name="a49"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$this</strong><strong>-&gt;</strong>setRedirect<strong>(</strong>JRoute<strong>::</strong>_<strong>(</strong><font color="#66cccc">'index.php?option=com_contact&amp;view=contact&amp;id='</font>.<strong>$stub</strong><strong>,&nbsp;</strong>false<strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a50"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">return&nbsp;</font>false<strong>;</strong></div></li>
<li><div class="src-line"><a name="a51"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a52"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a53"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a54"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Contact&nbsp;plugins</font></div></li>
<li><div class="src-line"><a name="a55"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JPluginHelper<strong>::</strong>importPlugin<strong>(</strong><font color="#66cccc">'contact'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a56"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$dispatcher&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;JDispatcher<strong>::</strong>getInstance<strong>(</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a57"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a58"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Validate&nbsp;the&nbsp;posted&nbsp;data.</font></div></li>
<li><div class="src-line"><a name="a59"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$form&nbsp;</strong>=&nbsp;<strong>$model</strong><strong>-&gt;</strong>getForm<strong>(</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a60"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if&nbsp;</font><strong>(</strong><strong>!</strong><strong>$form</strong><strong>)&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a61"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JError<strong>::</strong>raiseError<strong>(</strong>500<strong>,&nbsp;</strong><strong>$model</strong><strong>-&gt;</strong>getError<strong>(</strong><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a62"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">return&nbsp;</font>false<strong>;</strong></div></li>
<li><div class="src-line"><a name="a63"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a64"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a65"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$validate&nbsp;</strong>=&nbsp;<strong>$model</strong><strong>-&gt;</strong>validate<strong>(</strong><strong>$form</strong><strong>,&nbsp;</strong><strong>$data</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a66"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a67"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if&nbsp;</font><strong>(</strong><strong>$validate&nbsp;</strong>===&nbsp;false<strong>)&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a68"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Get&nbsp;the&nbsp;validation&nbsp;messages.</font></div></li>
<li><div class="src-line"><a name="a69"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$errors&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$model</strong><strong>-&gt;</strong>getErrors<strong>(</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a70"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Push&nbsp;up&nbsp;to&nbsp;three&nbsp;validation&nbsp;messages&nbsp;out&nbsp;to&nbsp;the&nbsp;user.</font></div></li>
<li><div class="src-line"><a name="a71"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">for&nbsp;</font><strong>(</strong><strong>$i&nbsp;</strong>=&nbsp;0<strong>,&nbsp;</strong><strong>$n&nbsp;</strong>=&nbsp;<a href="http://www.php.net/count">count</a><strong>(</strong><strong>$errors</strong><strong>)</strong><strong>;&nbsp;</strong><strong>$i&nbsp;</strong>&lt;&nbsp;<strong>$n&nbsp;</strong>&amp;&amp;&nbsp;<strong>$i&nbsp;</strong>&lt;&nbsp;3<strong>;&nbsp;</strong><strong>$i</strong>++<strong>)&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a72"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if&nbsp;</font><strong>(</strong><strong>$errors</strong><strong>[</strong><strong>$i</strong><strong>]&nbsp;</strong>instanceof&nbsp;Exception<strong>)&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a73"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$app</strong><strong>-&gt;</strong>enqueueMessage<strong>(</strong><strong>$errors</strong><strong>[</strong><strong>$i</strong><strong>]</strong><strong>-&gt;</strong>getMessage<strong>(</strong><strong>)</strong><strong>,&nbsp;</strong><font color="#66cccc">'warning'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a74"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}&nbsp;</strong>else&nbsp;<strong>{</strong></div></li>
<li><div class="src-line"><a name="a75"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$app</strong><strong>-&gt;</strong>enqueueMessage<strong>(</strong><strong>$errors</strong><strong>[</strong><strong>$i</strong><strong>]</strong><strong>,&nbsp;</strong><font color="#66cccc">'warning'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a76"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a77"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a78"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a79"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Save&nbsp;the&nbsp;data&nbsp;in&nbsp;the&nbsp;session.</font></div></li>
<li><div class="src-line"><a name="a80"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$app</strong><strong>-&gt;</strong>setUserState<strong>(</strong><font color="#66cccc">'com_contact.contact.data'</font><strong>,&nbsp;</strong><strong>$data</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a81"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a82"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Redirect&nbsp;back&nbsp;to&nbsp;the&nbsp;contact&nbsp;form.</font></div></li>
<li><div class="src-line"><a name="a83"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$this</strong><strong>-&gt;</strong>setRedirect<strong>(</strong>JRoute<strong>::</strong>_<strong>(</strong><font color="#66cccc">'index.php?option=com_contact&amp;view=contact&amp;id='</font>.<strong>$stub</strong><strong>,&nbsp;</strong>false<strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a84"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">return&nbsp;</font>false<strong>;</strong></div></li>
<li><div class="src-line"><a name="a85"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a86"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a87"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Validation&nbsp;succeeded,&nbsp;continue&nbsp;with&nbsp;custom&nbsp;handlers</font></div></li>
<li><div class="src-line"><a name="a88"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$results&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$dispatcher</strong><strong>-&gt;</strong>trigger<strong>(</strong><font color="#66cccc">'onValidateContact'</font><strong>,&nbsp;</strong>array<strong>(</strong><strong>&amp;</strong><strong>$contact</strong><strong>,&nbsp;</strong><strong>&amp;</strong><strong>$data</strong><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a89"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a90"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">foreach&nbsp;</font><strong>(</strong><strong>$results&nbsp;</strong>as&nbsp;<strong>$result</strong><strong>)&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a91"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if&nbsp;</font><strong>(</strong><strong>$result&nbsp;</strong>instanceof&nbsp;Exception<strong>)&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a92"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">return&nbsp;</font>false<strong>;</strong></div></li>
<li><div class="src-line"><a name="a93"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a94"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a95"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a96"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Passed&nbsp;Validation:&nbsp;Process&nbsp;the&nbsp;contact&nbsp;plugins&nbsp;to&nbsp;integrate&nbsp;with&nbsp;other&nbsp;applications</font></div></li>
<li><div class="src-line"><a name="a97"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$results&nbsp;</strong>=&nbsp;<strong>$dispatcher</strong><strong>-&gt;</strong>trigger<strong>(</strong><font color="#66cccc">'onSubmitContact'</font><strong>,&nbsp;</strong>array<strong>(</strong><strong>&amp;</strong><strong>$contact</strong><strong>,&nbsp;</strong><strong>&amp;</strong><strong>$data</strong><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a98"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a99"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Send&nbsp;the&nbsp;email</font></div></li>
<li><div class="src-line"><a name="a100"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$sent&nbsp;</strong>=&nbsp;false<strong>;</strong></div></li>
<li><div class="src-line"><a name="a101"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if&nbsp;</font><strong>(</strong><strong>!</strong><strong>$params</strong><strong>-&gt;</strong>get<strong>(</strong><font color="#66cccc">'custom_reply'</font><strong>))&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a102"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$sent&nbsp;</strong>=&nbsp;<strong>$this</strong><strong>-&gt;</strong><a href="../Joomla-Site/Contact/ContactControllerContact.html#method_sendEmail">_sendEmail</a><strong>(</strong><strong>$data</strong><strong>,&nbsp;</strong><strong>$contact</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a103"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a104"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a105"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Set&nbsp;the&nbsp;success&nbsp;message&nbsp;if&nbsp;it&nbsp;was&nbsp;a&nbsp;success</font></div></li>
<li><div class="src-line"><a name="a106"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if&nbsp;</font><strong>(</strong><strong>!</strong>JError<strong>::</strong>isError<strong>(</strong><strong>$sent</strong><strong>))&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a107"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$msg&nbsp;</strong>=&nbsp;JText<strong>::</strong>_<strong>(</strong><font color="#66cccc">'COM_CONTACT_EMAIL_THANKS'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a108"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a109"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a110"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Flush&nbsp;the&nbsp;data&nbsp;from&nbsp;the&nbsp;session</font></div></li>
<li><div class="src-line"><a name="a111"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$app</strong><strong>-&gt;</strong>setUserState<strong>(</strong><font color="#66cccc">'com_contact.contact.data'</font><strong>,&nbsp;</strong>null<strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a112"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a113"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Redirect&nbsp;if&nbsp;it&nbsp;is&nbsp;set&nbsp;in&nbsp;the&nbsp;parameters,&nbsp;otherwise&nbsp;redirect&nbsp;back&nbsp;to&nbsp;where&nbsp;we&nbsp;came&nbsp;from</font></div></li>
<li><div class="src-line"><a name="a114"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if&nbsp;</font><strong>(</strong><strong>$contact</strong><strong>-&gt;</strong>params<strong>-&gt;</strong>get<strong>(</strong><font color="#66cccc">'redirect'</font><strong>))&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a115"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$this</strong><strong>-&gt;</strong>setRedirect<strong>(</strong><strong>$contact</strong><strong>-&gt;</strong>params<strong>-&gt;</strong>get<strong>(</strong><font color="#66cccc">'redirect'</font><strong>)</strong><strong>,&nbsp;</strong><strong>$msg</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a116"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}&nbsp;</strong>else&nbsp;<strong>{</strong></div></li>
<li><div class="src-line"><a name="a117"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$this</strong><strong>-&gt;</strong>setRedirect<strong>(</strong>JRoute<strong>::</strong>_<strong>(</strong><font color="#66cccc">'index.php?option=com_contact&amp;view=contact&amp;id='</font>.<strong>$stub</strong><strong>,&nbsp;</strong>false<strong>)</strong><strong>,&nbsp;</strong><strong>$msg</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a118"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a119"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a120"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">return&nbsp;</font>true<strong>;</strong></div></li>
<li><div class="src-line"><a name="a121"></a>&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a122"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a123"></a>&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">private&nbsp;</font><font color="blue">function&nbsp;</font><a href="../Joomla-Site/Contact/ContactControllerContact.html#method_sendEmail">_sendEmail</a><strong>(</strong><strong>$data</strong><strong>,&nbsp;</strong><strong>$contact</strong><strong>)</strong></div></li>
<li><div class="src-line"><a name="a124"></a>&nbsp;&nbsp;&nbsp;&nbsp;<strong>{</strong></div></li>
<li><div class="src-line"><a name="a125"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$app&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;JFactory<strong>::</strong>getApplication<strong>(</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a126"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$params&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;JComponentHelper<strong>::</strong>getParams<strong>(</strong><font color="#66cccc">'com_contact'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a127"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if&nbsp;</font><strong>(</strong><strong>$contact</strong><strong>-&gt;</strong>email_to&nbsp;==&nbsp;<font color="#66cccc">''&nbsp;</font>&amp;&amp;&nbsp;<strong>$contact</strong><strong>-&gt;</strong>user_id&nbsp;!=&nbsp;0<strong>)&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a128"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$contact_user&nbsp;</strong>=&nbsp;JUser<strong>::</strong>getInstance<strong>(</strong><strong>$contact</strong><strong>-&gt;</strong>user_id<strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a129"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$contact</strong><strong>-&gt;</strong>email_to&nbsp;=&nbsp;<strong>$contact_user</strong><strong>-&gt;</strong>get<strong>(</strong><font color="#66cccc">'email'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a130"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a131"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mailfrom&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$app</strong><strong>-&gt;</strong>getCfg<strong>(</strong><font color="#66cccc">'mailfrom'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a132"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$fromname&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$app</strong><strong>-&gt;</strong>getCfg<strong>(</strong><font color="#66cccc">'fromname'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a133"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$sitename&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$app</strong><strong>-&gt;</strong>getCfg<strong>(</strong><font color="#66cccc">'sitename'</font><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a134"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$copytext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;JText<strong>::</strong>sprintf<strong>(</strong><font color="#66cccc">'COM_CONTACT_COPYTEXT_OF'</font><strong>,&nbsp;</strong><strong>$contact</strong><strong>-&gt;</strong>name<strong>,&nbsp;</strong><strong>$sitename</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a135"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a136"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$data</strong><strong>[</strong><font color="#66cccc">'contact_name'</font><strong>]</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a137"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$email&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$data</strong><strong>[</strong><font color="#66cccc">'contact_email'</font><strong>]</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a138"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$subject&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$data</strong><strong>[</strong><font color="#66cccc">'contact_subject'</font><strong>]</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a139"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$body&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$data</strong><strong>[</strong><font color="#66cccc">'contact_message'</font><strong>]</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a140"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a141"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;Prepare&nbsp;email&nbsp;body</font></div></li>
<li><div class="src-line"><a name="a142"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$prefix&nbsp;</strong>=&nbsp;JText<strong>::</strong>sprintf<strong>(</strong><font color="#66cccc">'COM_CONTACT_ENQUIRY_TEXT'</font><strong>,&nbsp;</strong>JURI<strong>::</strong>base<strong>(</strong><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a143"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$body&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;<strong>$prefix</strong>.<font color="#66cccc">&quot;\n&quot;</font>.<strong>$name</strong>.<font color="#66cccc">'&nbsp;&lt;'</font>.<strong>$email</strong>.<font color="#66cccc">'&gt;'</font>.<font color="#66cccc">&quot;\r\n\r\n&quot;</font>.<a href="http://www.php.net/stripslashes">stripslashes</a><strong>(</strong><strong>$body</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a144"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a145"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail&nbsp;</strong>=&nbsp;JFactory<strong>::</strong>getMailer<strong>(</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a146"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>addRecipient<strong>(</strong><strong>$contact</strong><strong>-&gt;</strong>email_to<strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a147"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>addReplyTo<strong>(</strong>array<strong>(</strong><strong>$email</strong><strong>,&nbsp;</strong><strong>$name</strong><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a148"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>setSender<strong>(</strong>array<strong>(</strong><strong>$mailfrom</strong><strong>,&nbsp;</strong><strong>$fromname</strong><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a149"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>setSubject<strong>(</strong><strong>$sitename</strong>.<font color="#66cccc">':&nbsp;'</font>.<strong>$subject</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a150"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>setBody<strong>(</strong><strong>$body</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a151"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$sent&nbsp;</strong>=&nbsp;<strong>$mail</strong><strong>-&gt;</strong>Send<strong>(</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a152"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a153"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//If&nbsp;we&nbsp;are&nbsp;supposed&nbsp;to&nbsp;copy&nbsp;the&nbsp;sender,&nbsp;do&nbsp;so.</font></div></li>
<li><div class="src-line"><a name="a154"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a155"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="green">//&nbsp;check&nbsp;whether&nbsp;email&nbsp;copy&nbsp;function&nbsp;activated</font></div></li>
<li><div class="src-line"><a name="a156"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">if&nbsp;</font><strong>(&nbsp;</strong><a href="http://www.php.net/array_key_exists">array_key_exists</a><strong>(</strong><font color="#66cccc">'contact_email_copy'</font><strong>,&nbsp;</strong><strong>$data</strong><strong>)&nbsp;&nbsp;)&nbsp;</strong><strong>{</strong></div></li>
<li><div class="src-line"><a name="a157"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$copytext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;JText<strong>::</strong>sprintf<strong>(</strong><font color="#66cccc">'COM_CONTACT_COPYTEXT_OF'</font><strong>,&nbsp;</strong><strong>$contact</strong><strong>-&gt;</strong>name<strong>,&nbsp;</strong><strong>$sitename</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a158"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$copytext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>.=&nbsp;<font color="#66cccc">&quot;\r\n\r\n&quot;</font>.<strong>$body</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a159"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$copysubject&nbsp;&nbsp;&nbsp;&nbsp;</strong>=&nbsp;JText<strong>::</strong>sprintf<strong>(</strong><font color="#66cccc">'COM_CONTACT_COPYSUBJECT_OF'</font><strong>,&nbsp;</strong><strong>$subject</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a160"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a161"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail&nbsp;</strong>=&nbsp;JFactory<strong>::</strong>getMailer<strong>(</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a162"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>addRecipient<strong>(</strong><strong>$email</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a163"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>addReplyTo<strong>(</strong>array<strong>(</strong><strong>$email</strong><strong>,&nbsp;</strong><strong>$name</strong><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a164"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>setSender<strong>(</strong>array<strong>(</strong><strong>$mailfrom</strong><strong>,&nbsp;</strong><strong>$fromname</strong><strong>))</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a165"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>setSubject<strong>(</strong><strong>$copysubject</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a166"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$mail</strong><strong>-&gt;</strong>setBody<strong>(</strong><strong>$copytext</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a167"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>$sent&nbsp;</strong>=&nbsp;<strong>$mail</strong><strong>-&gt;</strong>Send<strong>(</strong><strong>)</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a168"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a169"></a>&nbsp;</div></li>
<li><div class="src-line"><a name="a170"></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="blue">return&nbsp;</font><strong>$sent</strong><strong>;</strong></div></li>
<li><div class="src-line"><a name="a171"></a>&nbsp;&nbsp;&nbsp;&nbsp;<strong>}</strong></div></li>
<li><div class="src-line"><a name="a172"></a><strong>}</strong></div></li>
</pre>
	<div id="credit">
		<hr>
		Documentation generated on Sun, 29 Jul 2012 11:24:01 +0400 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</div>
</body>
</html>